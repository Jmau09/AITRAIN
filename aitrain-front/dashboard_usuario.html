<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Dashboard - AiTrain</title>

<!-- ICONS -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

<style>
*{margin:0; padding:0; box-sizing:border-box; font-family:Inter,Segoe UI,Arial,sans-serif;}
body{background:#0d0d0d; color:#fff;}

/* NAVBAR */
.navbar{width:100%; background:#141414; padding:15px 30px; display:flex; justify-content:space-between; align-items:center; border-bottom:2px solid #ef4444;}
.nav-left{display:flex; gap:15px; align-items:center;}
.nav-left img{width:55px; cursor:pointer;}
.nav-right{display:flex; gap:20px;}
.nav-right button{background:none; border:none; color:#fff; font-size:17px; cursor:pointer; transition:0.2s;}
.nav-right button:hover{color:#ef4444;}

/* MAIN CONTENT */
.container{padding:40px; display:flex; flex-direction:column; gap:30px;}

/* BIG CARDS */
.big-card{background:#1a1a1a; border:1px solid #ef4444; border-radius:18px; padding:25px; box-shadow:0 0 15px rgba(239,68,68,0.3); animation:fadeIn .4s ease;}
.big-card h2{color:#ef4444; display:flex; align-items:center; gap:10px; margin-bottom:10px;}
.big-card p{color:#ccc; font-size:15px; margin-top:10px;}

/* STATS GRID */
.stats-grid{display:grid; grid-template-columns:repeat(auto-fit,minmax(250px,1fr)); gap:25px;}

/* INDIVIDUAL STAT CARD */
.stat-card{background:#111; border-radius:18px; padding:20px; display:flex; flex-direction:column; align-items:center; justify-content:center; box-shadow:0 0 10px rgba(239,68,68,0.2); position:relative; transition:0.3s;}
.stat-card:hover{transform:translateY(-5px);}
.stat-card h3{color:#fff; margin-bottom:10px;}
.stat-value{font-size:32px; font-weight:bold; margin-bottom:10px;}
.progress-bar{width:100%; height:12px; border-radius:10px; background:#333; overflow:hidden; margin-top:5px;}
.progress-fill{height:100%; border-radius:10px; background:#ef4444; width:0; transition:width 1s ease;}
.stat-icon{font-size:28px; margin-bottom:5px; color:#ef4444;}

/* Slider frases motivadoras */
.slider-wrapper{
  overflow:hidden;
  position:relative;
  height:40px;
  margin-top:10px;
}

.slider{
  display:flex;
  animation:slide 12s linear infinite;
}

.slide{
  min-width:100%;
  text-align:center;
  color:#fff;
  font-size:16px;
  padding:5px 0;
}

/* Animaci√≥n de desplazamiento */
@keyframes slide{
  0%{transform:translateX(0);}
  25%{transform:translateX(-100%);}
  50%{transform:translateX(-200%);}
  75%{transform:translateX(-300%);}
  100%{transform:translateX(0);}
}

/* Accordion consejos de salud */
.accordion-item{
  margin-top:10px;
  border-radius:12px;
  overflow:hidden;
  border:1px solid #ef4444;
  background:#111;
}

.accordion-btn{
  width:100%;
  text-align:left;
  background:none;
  border:none;
  color:#fff;
  padding:12px 15px;
  font-size:15px;
  cursor:pointer;
  display:flex;
  align-items:center;
  gap:10px;
}

.accordion-btn:hover{
  background:rgba(239,68,68,0.1);
}

.accordion-content{
  max-height:0;
  overflow:hidden;
  transition:max-height 0.3s ease;
  padding:0 15px;
  color:#ccc;
  font-size:14px;
}

.accordion-content p{
  margin:10px 0;
}

/* Motivaci√≥n y Consejos - tarjetas hover */
.motivacion-grid, .consejos-grid{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(200px,1fr));
  gap:15px;
  margin-top:10px;
}

.motiv-card, .consejo-card{
  background:#1a1a1a;
  border:1px solid #ef4444;
  border-radius:15px;
  padding:15px;
  color:#fff;
  font-size:14px;
  display:flex;
  align-items:flex-start;
  gap:10px;
  box-shadow:0 0 10px rgba(239,68,68,0.2);
  transition:0.3s;
}

.motiv-card:hover, .consejo-card:hover{
  transform:translateY(-5px);
  box-shadow:0 0 15px rgba(239,68,68,0.4);
}

.motiv-card i, .consejo-card i{
  color:#ef4444;
  font-size:18px;
  flex-shrink:0;
}

/* Animaci√≥n general */
@keyframes fadeIn{from{opacity:0; transform:translateY(10px);}to{opacity:1; transform:translateY(0);}}
</style>
</head>
<body>

<!-- NAVBAR -->
<div class="navbar">
  <div class="nav-left">
    <img src="brazo.png" alt="logo" onclick="location.href='dashboard_usuario.html'">
    <h2 style="color:#ef4444;">AiTrain Dashboard</h2>
  </div>
  <div class="nav-right">
    <button onclick="location.href='chat.html'"><i class="fas fa-robot"></i> Chatbot</button>
    <button onclick="location.href='perfil.html'"><i class="fas fa-user"></i> Perfil</button>
    <button onclick="cerrarSesion()"><i class="fas fa-door-open"></i> Cerrar sesi√≥n</button>
  </div>
</div>

<!-- MAIN CONTENT -->
<div class="container">

  <!-- MI RUTINA -->
  <div class="big-card">
    <h2><i class="fas fa-dumbbell"></i> Mi Rutina Actual</h2>
    <p id="rutinaText">A√∫n no tienes rutina generada. ¬°P√≠desela al chatbot!</p>
  </div>

  <!-- MI ALIMENTACI√ìN -->
  <div class="big-card">
    <h2><i class="fas fa-apple-alt"></i> Mi Alimentaci√≥n</h2>
    <p id="alimentacionText">Todav√≠a no se ha generado tu alimentaci√≥n. Solic√≠tala al chatbot.</p>
  </div>

  <!-- STATS DEL USUARIO -->
  <div class="stats-grid">
    <!-- Peso -->
    <div class="stat-card">
      <div class="stat-icon"><i class="fas fa-weight"></i></div>
      <h3>Peso</h3>
      <div class="stat-value" id="valorPeso">0 kg</div>
      <div class="progress-bar"><div class="progress-fill" id="progressPeso"></div></div>
    </div>

    <!-- Estatura -->
    <div class="stat-card">
      <div class="stat-icon"><i class="fas fa-ruler-vertical"></i></div>
      <h3>Estatura</h3>
      <div class="stat-value" id="valorEstatura">0 cm</div>
      <div class="progress-bar"><div class="progress-fill" id="progressEstatura"></div></div>
    </div>

    <!-- IMC -->
    <div class="stat-card">
      <div class="stat-icon"><i class="fas fa-chart-line"></i></div>
      <h3>IMC</h3>
      <div class="stat-value" id="valorIMC">0</div>
      <div class="progress-bar"><div class="progress-fill" id="progressIMC"></div></div>
    </div>
  </div>

  <!-- Frases motivadoras -->
  <div class="big-card">
    <h2><i class="fas fa-star"></i> Frases motivadoras</h2>
    <div class="slider-wrapper">
      <div class="slider" id="motivSlider">
        <div class="slide">üèãÔ∏è ‚ÄúEl √©xito no se logra solo, ¬°entrena cada d√≠a!‚Äù</div>
        <div class="slide">üèÉ ‚ÄúNo te compares con otros, compite contigo mismo.‚Äù</div>
        <div class="slide">üî• ‚ÄúCada esfuerzo suma. ¬°Sigue adelante!‚Äù</div>
        <div class="slide">üí™ ‚ÄúLa disciplina vence la motivaci√≥n temporal.‚Äù</div>
      </div>
    </div>
  </div>

  <!-- Consejos de salud (accordion mini-blog) -->
  <div class="big-card">
    <h2><i class="fas fa-heart"></i> Consejos de salud</h2>
    <div class="accordion">
      <div class="accordion-item">
        <button class="accordion-btn"><i class="fas fa-apple-alt"></i> Alimentaci√≥n saludable</button>
        <div class="accordion-content">
          <p>Incluye prote√≠nas magras, carbohidratos complejos y grasas saludables. Evita ultraprocesados y exceso de az√∫car.</p>
        </div>
      </div>
      <div class="accordion-item">
        <button class="accordion-btn"><i class="fas fa-water"></i> Hidrataci√≥n</button>
        <div class="accordion-content">
          <p>Bebe al menos 2 litros de agua al d√≠a. Mantente hidratado antes, durante y despu√©s de entrenar.</p>
        </div>
      </div>
      <div class="accordion-item">
        <button class="accordion-btn"><i class="fas fa-bed"></i> Sue√±o y recuperaci√≥n</button>
        <div class="accordion-content">
          <p>Duerme entre 7 y 8 horas diarias. La recuperaci√≥n muscular ocurre mientras descansas.</p>
        </div>
      </div>
      <div class="accordion-item">
        <button class="accordion-btn"><i class="fas fa-running"></i> Ejercicio</button>
        <div class="accordion-content">
          <p>Realiza al menos 30 minutos de actividad f√≠sica diaria. Alterna cardio, fuerza y estiramientos.</p>
        </div>
      </div>
    </div>
  </div>

</div>

<script>
// =====================================
// CARGAR VALORACI√ìN DEL USUARIO
// =====================================
async function cargarValoracion() {
  const email = localStorage.getItem("aitrain_user");
  if(!email) return;

  try {
    const res = await fetch(`http://localhost:8080/api/aitrain/valoracion/buscar/${email}`);
    if(!res.ok) return;
    const data = await res.json();
    const v = data.valoracion;

    mostrarDatos(v.pesoKg, v.estaturaCm, v.imc);

    // Simular rutina y alimentaci√≥n
    document.getElementById("rutinaText").innerText = "üèãÔ∏è 3x12 Sentadillas, 3x10 Press Banca, 2x15 Curl B√≠ceps";
    document.getElementById("alimentacionText").innerText = "ü•ó Prote√≠nas 40%, Carbs 40%, Grasas 20%";

  } catch (e) {
    console.error("Error cargando valoraci√≥n.");
  }
}

// =====================================
// MOSTRAR DATOS EN TARJETAS
// =====================================
function mostrarDatos(peso, estatura, imc){
  // Peso
  document.getElementById("valorPeso").innerText = peso + " kg";
  document.getElementById("progressPeso").style.width = Math.min((peso/100)*100,100) + "%";

  // Estatura
  document.getElementById("valorEstatura").innerText = estatura + " cm";
  document.getElementById("progressEstatura").style.width = Math.min((estatura/200)*100,100) + "%";

  // IMC
  document.getElementById("valorIMC").innerText = imc.toFixed(1);
  let color = "#22c55e"; // Normal
  if(imc<18.5) color = "#3b82f6";
  else if(imc>=25 && imc<30) color = "#f59e0b";
  else if(imc>=30) color = "#ef4444";
  document.getElementById("progressIMC").style.width = Math.min((imc/40)*100,100) + "%";
  document.getElementById("progressIMC").style.backgroundColor = color;
}

cargarValoracion();

// =====================================
// CERRAR SESI√ìN
// =====================================
function cerrarSesion(){
  localStorage.removeItem("aitrain_user");
  window.location.href = "index.html";
}

// Accordion toggle
const accBtns = document.querySelectorAll('.accordion-btn');
accBtns.forEach(btn=>{
  btn.addEventListener('click', ()=>{
    const content = btn.nextElementSibling;
    const isOpen = content.style.maxHeight && content.style.maxHeight !== "0px";
    // Cerrar todos
    document.querySelectorAll('.accordion-content').forEach(c=>c.style.maxHeight="0");
    if(!isOpen) content.style.maxHeight = content.scrollHeight + "px";
  });
});
</script>

</body>
</html>
